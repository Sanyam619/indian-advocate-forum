// This is your Prisma schema file

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ADMIN
  ADVOCATE
  USER
}

model User {
  id                  String    @id @default(auto()) @map("_id") @db.ObjectId
  auth0Id             String    @unique
  email               String    @unique
  fullName            String
  role                UserRole  @default(USER)
  profilePhoto        String?
  barRegistrationNo   String?
  yearsOfExperience   String?
  city                String?
  phoneNumber         String?
  isProfileSetup      Boolean   @default(false)
  
  // Extended advocate profile fields
  bio                 String?
  education           String[]  @default([])
  languages           String[]  @default([])
  officeAddress       String?
  specialization      String[]  @default([])
  
  // Payment tracking
  paymentStatus       String?   // "pending", "completed", "failed"
  stripePaymentIntentId String?
  
  // Premium subscription
  isPremium           Boolean   @default(false)
  premiumPlan         String?   // "monthly", "6months", "yearly", "3years"
  premiumExpiresAt    DateTime?
  stripeSubscriptionId String?
  
  createdAt           DateTime  @default(now())
  updatedAt           DateTime  @updatedAt
  news                News[]
  payments            Payment[]
  meetings            Meeting[]
  podcasts            Podcast[]
}

model News {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  content     String
  imageUrl    String?
  videoUrl    String?
  videoThumbnail String?
  category    String
  courtName   String?
  tags        String[] @default([])
  readTime    Int?
  author      User     @relation(fields: [authorId], references: [id])
  authorId    String   @db.ObjectId
  publishDate DateTime @default(now())
  views       Int      @default(0)
  likes       Int      @default(0)
  hasVideo    Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Payment {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  user        User     @relation(fields: [userId], references: [id])
  userId      String   @db.ObjectId
  amount      Float
  currency    String   @default("INR")
  status      String
  stripeId    String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Meeting {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  host        User     @relation(fields: [hostId], references: [id])
  hostId      String   @db.ObjectId
  zoomMeetingId String
  topic       String
  startTime   DateTime
  duration    Int
  joinUrl     String
  password    String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Podcast {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  description String
  videoUrl    String
  thumbnailUrl String?
  category    String
  tags        String[] @default([])
  uploadedBy  User     @relation(fields: [uploadedById], references: [id])
  uploadedById String  @db.ObjectId
  publishDate DateTime @default(now())
  isPublished Boolean  @default(true)
  playCount   Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Judge {
  id              String   @id @default(auto()) @map("_id") @db.ObjectId
  name            String
  fullName        String
  designation     String
  court           String
  photoUrl        String?
  appointmentDate String?
  retirementDate  String?
  dateOfBirth     String?
  education       String[] @default([])
  biography       String?
  specializations String[] @default([])
  careerHighlights String[] @default([])
  notableJudgments String[] @default([])
  type            String   // "chief-justice" or "judge"
  status          String   // "current" or "former"
  category        String?  // "Current Chief Justice", "Current Judge", "Former Chief Justice", "Former Judge"
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt
}

model TeamMember {
  id                          String   @id @default(auto()) @map("_id") @db.ObjectId
  barRegistrationNo           String?
  title                       String?
  name                        String
  emailId                     String   @unique
  legalTitle                  String?
  phoneNo                     String?
  yearOfBirth                 String?
  placeOfPractice             String?
  address                     String?
  enrollment                  String?
  webinarPrimaryPreference    String?
  webinarSecondaryPreference  String?
  articleContribution         Boolean  @default(false) // Yes or No
  references                  String?  // "President" or "AVS" or "DG" or any position
  profilePhoto                String?  // Cloudinary URL
  role                        String   // "President", "DG", "AVS", "Secretary", "Member", etc.
  createdAt                   DateTime @default(now())
  updatedAt                   DateTime @updatedAt
}